
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Hipotecarios - Septiembre 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff7f00 0%, #ff9500 25%, #ffb347 75%, #ffffff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        /* Navigation Menu Styles */
        .nav-menu {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 15px 0;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(255, 127, 0, 0.15);
            backdrop-filter: blur(10px);
        }

        .nav-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 30px;
        }

        .nav-list {
            display: flex;
            justify-content: center;
            list-style: none;
            gap: 40px;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            color: #ff7f00;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: block;
        }

        .nav-link:hover, .nav-link.active {
            background: linear-gradient(135deg, #ff7f00, #ff9500);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 127, 0, 0.3);
        }

        /* Sedes Coopexpress en l√≠nea horizontal */
        .sedes-menu {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 10px 0;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(255, 127, 0, 0.1);
            display: none;
        }

        .sedes-menu.show {
            display: block;
        }

        .sedes-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 30px;
        }

        .sedes-list {
            display: flex;
            justify-content: center;
            list-style: none;
            gap: 30px;
            flex-wrap: wrap;
        }

        .sede-item {
            background: linear-gradient(135deg, #fff8f0, #ffffff);
            border: 2px solid rgba(255, 127, 0, 0.2);
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #ff7f00;
        }

        .sede-item:hover, .sede-item.active {
            background: linear-gradient(135deg, #ff7f00, #ff9500);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(255, 127, 0, 0.3);
        }

        .dropdown-item:hover {
            background: linear-gradient(135deg, #fff8f0, #ffede0);
            color: #ff7f00;
            padding-left: 25px;
        }

        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(255, 127, 0, 0.3);
            padding: 30px;
            backdrop-filter: blur(10px);
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
            min-height: 80vh;
        }

        .header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, #ff7f00, #ff9500);
            border-radius: 2px;
        }

        .header h1 {
            color: #ff7f00;
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(255, 127, 0, 0.2);
        }

        .header p {
            color: #666;
            font-size: 1.2rem;
            font-weight: 300;
        }

        /* Panel izquierdo - Lista de asesores */
        .asesores-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(255, 127, 0, 0.15);
            border: 1px solid rgba(255, 127, 0, 0.2);
            height: fit-content;
        }

        .asesores-title {
            color: #ff7f00;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }

        .asesores-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 2px;
            background: linear-gradient(90deg, #ff7f00, #ff9500);
        }

        .asesor-item {
            background: linear-gradient(135deg, #ffffff 0%, #fff8f0 100%);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .asesor-item:hover {
            border-color: #ff7f00;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(255, 127, 0, 0.2);
        }

        .asesor-item.active {
            background: linear-gradient(135deg, #ff7f00, #ff9500);
            color: white;
            border-color: #ff7f00;
            transform: translateX(8px);
            box-shadow: 0 8px 20px rgba(255, 127, 0, 0.3);
        }

        .asesor-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .asesor-preview {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Panel derecho - Detalles del asesor */
        .detalles-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .asesor-header {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(255, 127, 0, 0.15);
            border: 1px solid rgba(255, 127, 0, 0.2);
            text-align: center;
        }

        .asesor-header h2 {
            color: #ff7f00;
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .asesor-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: linear-gradient(135deg, #ff7f00, #ff9500);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(255, 127, 0, 0.1);
            border: 1px solid rgba(255, 127, 0, 0.2);
            min-height: 350px;
            display: flex;
            flex-direction: column;
        }

        .chart-container canvas {
            flex: 1;
            max-height: 300px !important;
        }

        .chart-title {
            color: #ff7f00;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
        }

        .chart-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 2px;
            background: linear-gradient(90deg, #ff7f00, #ff9500);
        }

        .estado-inicial {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 300px;
            color: #999;
            font-size: 1.2rem;
            text-align: center;
        }

        .estado-inicial .icono {
            font-size: 4rem;
            color: #ff7f00;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .resumen-table {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(255, 127, 0, 0.1);
            border: 1px solid rgba(255, 127, 0, 0.2);
            grid-column: 1 / -1;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th {
            background: linear-gradient(135deg, #ff7f00, #ff9500);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-radius: 5px;
        }

        .table td {
            padding: 10px 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .table tr:nth-child(even) {
            background-color: #fff8f0;
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            text-align: center;
            display: inline-block;
            min-width: 60px;
        }

        .badge-prospecto { background: rgba(255, 127, 0, 0.1); color: #ff7f00; border: 1px solid rgba(255, 127, 0, 0.3); }
        .badge-oportunidad { background: rgba(255, 149, 0, 0.1); color: #ff9500; border: 1px solid rgba(255, 149, 0, 0.3); }
        .badge-documentacion { background: rgba(255, 179, 71, 0.1); color: #cc7a00; border: 1px solid rgba(255, 179, 71, 0.3); }
        .badge-aprobado { background: rgba(50, 205, 50, 0.1); color: #32cd32; border: 1px solid rgba(50, 205, 50, 0.3); }
        .badge-desembolso { background: rgba(0, 128, 0, 0.1); color: #008000; border: 1px solid rgba(0, 128, 0, 0.3); }
        .badge-perdido { background: rgba(255, 0, 0, 0.1); color: #dc3545; border: 1px solid rgba(255, 0, 0, 0.3); }

        @media (max-width: 1024px) {
            .dashboard-container {
                grid-template-columns: 1fr;
                padding: 15px;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-list {
                gap: 20px;
            }
            
            .sedes-list {
                gap: 15px;
            }
        }

        /* Responsive para tablets */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .nav-container, .sedes-container {
                padding: 0 15px;
            }
            
            .nav-list {
                gap: 15px;
                flex-wrap: wrap;
            }
            
            .nav-link {
                font-size: 1rem;
                padding: 8px 15px;
            }
            
            .sedes-list {
                gap: 10px;
                justify-content: flex-start;
            }
            
            .sede-item {
                padding: 6px 12px;
                font-size: 0.9rem;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 0.9rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .dashboard-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .asesores-panel {
                order: 2;
            }
            
            .main-content {
                order: 1;
            }
        }

        /* Responsive para m√≥viles */
        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .nav-container, .sedes-container {
                padding: 0 10px;
            }
            
            .nav-list {
                flex-direction: column;
                gap: 5px;
                align-items: center;
            }
            
            .nav-link {
                width: 200px;
                text-align: center;
                font-size: 0.95rem;
                padding: 10px 15px;
            }
            
            .sedes-list {
                flex-direction: column;
                gap: 8px;
                align-items: center;
            }
            
            .sede-item {
                width: 200px;
                text-align: center;
                padding: 8px 15px;
            }
            
            .header h1 {
                font-size: 1.5rem;
                text-align: center;
            }
            
            .header p {
                font-size: 0.85rem;
                text-align: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .stat-card {
                padding: 15px;
            }
            
            .stat-number {
                font-size: 1.8rem;
            }
            
            .stat-label {
                font-size: 0.85rem;
            }
            
            .asesores-panel {
                padding: 15px;
            }
            
            .asesor-item {
                padding: 12px;
                margin-bottom: 8px;
            }
            
            .asesor-nombre {
                font-size: 0.95rem;
            }
            
            .asesor-stats span {
                font-size: 0.8rem;
            }
            
            .charts-container {
                padding: 15px;
            }
            
            .chart-title {
                font-size: 1.1rem;
            }
            
            /* Mejorar tabla de clientes en m√≥vil */
            .clientes-table {
                font-size: 0.8rem;
                overflow-x: auto;
                display: block;
                white-space: nowrap;
            }
            
            .clientes-table th,
            .clientes-table td {
                padding: 8px 4px;
                min-width: 80px;
            }
            
            /* Hacer scroll horizontal en tablas peque√±as */
            .table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            /* Hacer que el gr√°fico sea m√°s peque√±o en m√≥vil */
            .chart-container {
                height: 250px !important;
            }
            
            /* Ajustar badges en m√≥vil */
            .cliente-estado {
                font-size: 0.7rem;
                padding: 2px 6px;
            }
        }

        /* Estilos para el filtro de fechas */
        .filtro-fechas {
            animation: fadeIn 0.3s ease;
        }

        .filtro-fechas select {
            transition: all 0.3s ease;
            outline: none;
        }

        .filtro-fechas select:focus {
            border-color: #ff7f00;
            box-shadow: 0 0 0 3px rgba(255, 127, 0, 0.1);
            transform: translateY(-1px);
        }

        .filtro-fechas select:hover {
            border-color: rgba(255, 127, 0, 0.5);
            box-shadow: 0 2px 8px rgba(255, 127, 0, 0.15);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100%); }
        }
    </style>
</head>
<body>
    <!-- Navigation Menu -->
    <nav class="nav-menu">
        <div class="nav-container">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="#" class="nav-link" id="agencia-central-link" onclick="mostrarAgenciaCentral()">Agencia Central</a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" id="coopexpress-link" onclick="mostrarCoopexpress()">Coopexpress</a>
                </li>
            </ul>
            
            <!-- Filtro de fechas -->
            <div class="filtro-fechas" style="text-align: center; margin-top: 15px; padding: 20px; border-top: 1px solid rgba(255, 127, 0, 0.2); background: linear-gradient(135deg, rgba(255, 127, 0, 0.05), rgba(255, 149, 0, 0.08));">
                <div style="margin-bottom: 15px;">
                    <h4 style="color: #ff7f00; font-weight: 600; margin: 0 0 10px 0; font-size: 1.1rem;">üìÖ Filtrar por Rango de Fechas</h4>
                    <p style="color: #666; margin: 0; font-size: 0.9rem;">Selecciona el per√≠odo que deseas analizar</p>
                </div>
                
                <div class="rango-fechas" style="display: flex; align-items: center; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <div class="fecha-grupo" style="display: flex; flex-direction: column; align-items: center;">
                        <label style="color: #ff7f00; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Fecha Inicio</label>
                        <input type="date" id="fecha-inicio" 
                               style="padding: 10px 15px; border: 2px solid rgba(255, 127, 0, 0.3); border-radius: 12px; background: white; color: #333; font-weight: 500; font-size: 0.95rem; box-shadow: 0 2px 8px rgba(255, 127, 0, 0.1); transition: all 0.3s ease;"
                               value="2025-09-01" 
                               min="2025-09-01" 
                               max="2025-09-30"
                               onchange="aplicarFiltroRango()"
                               onfocus="this.style.borderColor='#ff7f00'; this.style.boxShadow='0 4px 12px rgba(255, 127, 0, 0.2)'"
                               onblur="this.style.borderColor='rgba(255, 127, 0, 0.3)'; this.style.boxShadow='0 2px 8px rgba(255, 127, 0, 0.1)'">
                    </div>
                    
                    <div style="color: #ff7f00; font-size: 1.2rem; font-weight: bold; margin-top: 20px;">‚Üí</div>
                    
                    <div class="fecha-grupo" style="display: flex; flex-direction: column; align-items: center;">
                        <label style="color: #ff7f00; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Fecha Fin</label>
                        <input type="date" id="fecha-fin" 
                               style="padding: 10px 15px; border: 2px solid rgba(255, 127, 0, 0.3); border-radius: 12px; background: white; color: #333; font-weight: 500; font-size: 0.95rem; box-shadow: 0 2px 8px rgba(255, 127, 0, 0.1); transition: all 0.3s ease;"
                               value="2025-09-30" 
                               min="2025-09-01" 
                               max="2025-09-30"
                               onchange="aplicarFiltroRango()"
                               onfocus="this.style.borderColor='#ff7f00'; this.style.boxShadow='0 4px 12px rgba(255, 127, 0, 0.2)'"
                               onblur="this.style.borderColor='rgba(255, 127, 0, 0.3)'; this.style.boxShadow='0 2px 8px rgba(255, 127, 0, 0.1)'">
                    </div>
                    
                    <div class="botones-rapidos" style="display: flex; flex-direction: column; align-items: center; margin-left: 10px;">
                        <label style="color: #ff7f00; font-weight: 600; margin-bottom: 8px; font-size: 0.9rem;">Accesos R√°pidos</label>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <button onclick="seleccionarRangoRapido('semana1')" 
                                    style="padding: 6px 12px; background: linear-gradient(135deg, #ff7f00, #ff9500); color: white; border: none; border-radius: 8px; font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(255, 127, 0, 0.2);"
                                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(255, 127, 0, 0.3)'"
                                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(255, 127, 0, 0.2)'">
                                Semana 1
                            </button>
                            <button onclick="seleccionarRangoRapido('semana2')" 
                                    style="padding: 6px 12px; background: linear-gradient(135deg, #ff7f00, #ff9500); color: white; border: none; border-radius: 8px; font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(255, 127, 0, 0.2);"
                                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(255, 127, 0, 0.3)'"
                                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(255, 127, 0, 0.2)'">
                                Semana 2
                            </button>
                            <button onclick="seleccionarRangoRapido('mes')" 
                                    style="padding: 6px 12px; background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 8px; font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(40, 167, 69, 0.2);"
                                    onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(40, 167, 69, 0.3)'"
                                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 4px rgba(40, 167, 69, 0.2)'">
                                Todo el Mes
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="rango-info" style="margin-top: 15px; padding: 10px 15px; background: rgba(255, 127, 0, 0.1); border-radius: 8px; color: #ff7f00; font-weight: 500; font-size: 0.95rem;">
                    üìä Mostrando datos de todo septiembre (1 - 30 septiembre 2025)
                </div>
            </div>
        </div>
    </nav>

    <!-- Sedes Coopexpress -->
    <div class="sedes-menu" id="sedes-menu">
        <div class="sedes-container">
            <ul class="sedes-list">
                <li class="sede-item" onclick="seleccionarSede('escuintla')">Escuintla</li>
                <li class="sede-item" onclick="seleccionarSede('coban')">Cob√°n</li>
                <li class="sede-item" onclick="seleccionarSede('4caminos')">4 Caminos</li>
                <li class="sede-item" onclick="seleccionarSede('peten')">Pet√©n</li>
                <li class="sede-item" onclick="seleccionarSede('mazatenango')">Mazatenango</li>
            </ul>
        </div>
    </div>
    <div class="dashboard-container">
        <div class="header">
            <h1>Dashboard Hipotecarios</h1>
            <p>An√°lisis de Asignaciones por Asesor - Septiembre 2025</p>
            
            <!-- Estad√≠sticas Generales de Agencia Central -->
            <div id="stats-agencia-central" class="stats-generales" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 20px; max-width: 800px; margin-left: auto; margin-right: auto;">
                <div class="stat-card-general" style="background: linear-gradient(135deg, #ff7f00, #ff9500); color: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 10px 30px rgba(255, 127, 0, 0.2);">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">251</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Total Asignados</div>
                    <div style="font-size: 0.8rem; opacity: 0.7; margin-top: 5px;">Agencia Central</div>
                </div>
                <div class="stat-card-general" style="background: linear-gradient(135deg, #32cd32, #228b22); color: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 10px 30px rgba(50, 205, 50, 0.2);">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">157</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Activos</div>
                    <div style="font-size: 0.8rem; opacity: 0.7; margin-top: 5px;">62.5%</div>
                </div>
                <div class="stat-card-general" style="background: linear-gradient(135deg, #dc3545, #c82333); color: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 10px 30px rgba(220, 53, 69, 0.2);">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">94</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Perdidos</div>
                    <div style="font-size: 0.8rem; opacity: 0.7; margin-top: 5px;">37.5%</div>
                </div>
                <div class="stat-card-general" style="background: linear-gradient(135deg, #6f42c1, #5a32a3); color: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 10px 30px rgba(111, 66, 193, 0.2);">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 5px;">8</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Total Asesores</div>
                    <div style="font-size: 0.8rem; opacity: 0.7; margin-top: 5px;">Agencia Central</div>
                </div>
            </div>
        </div>

        <!-- Panel izquierdo - Lista de asesores -->
        <div class="asesores-panel">
            <h3 class="asesores-title">Asesores - Agencia Central</h3>
            <div id="asesoresList">
                <div class="asesor-item" onclick="seleccionarAsesor('miguel')">
                    <div class="asesor-name">Miguel</div>
                    <div class="asesor-preview">30 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('emely')">
                    <div class="asesor-name">Emely</div>
                    <div class="asesor-preview">18 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('gabriel')">
                    <div class="asesor-name">Gabriel</div>
                    <div class="asesor-preview">20 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('brayan')">
                    <div class="asesor-name">Brayan</div>
                    <div class="asesor-preview">28 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('rudy')">
                    <div class="asesor-name">Rudy</div>
                    <div class="asesor-preview">13 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('jorge')">
                    <div class="asesor-name">Jorge</div>
                    <div class="asesor-preview">18 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('carlos')">
                    <div class="asesor-name">Carlos</div>
                    <div class="asesor-preview">29 casos activos</div>
                </div>
                <div class="asesor-item" onclick="seleccionarAsesor('kevin')">
                    <div class="asesor-name">Kevin</div>
                    <div class="asesor-preview">1 caso activo</div>
                </div>
            </div>
        </div>

        <!-- Panel derecho - Detalles del asesor seleccionado -->
        <div class="detalles-panel">
            <div id="contenidoAsesor">
                <div class="estado-inicial">
                    <div class="icono">üë§</div>
                    <p>Selecciona un asesor de la lista para ver sus detalles</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales para el filtro de fechas
        let fechaInicio = '2025-09-01';
        let fechaFin = '2025-09-30';
        let modoFiltro = 'rango'; // 'rango' para mostrar datos del rango completo
        
        // Funci√≥n para aplicar filtro por rango de fechas
        function aplicarFiltroRango() {
            // Calcular totales filtrados por rango para Agencia Central
            let totalClientes = 0, clientesActivos = 0, clientesPerdidos = 0, totalAsesores = 0;
            Object.values(asesoresData).forEach(asesor => {
                if (asesor && asesor.porFecha) {
                    Object.entries(asesor.porFecha).forEach(([fecha, datos]) => {
                        if (fecha >= fechaInicio && fecha <= fechaFin && !datos.sinDatos) {
                            totalClientes += datos.totalClientes || 0;
                            clientesActivos += datos.clientesActivos || 0;
                            clientesPerdidos += datos.clientesPerdidos || 0;
                        }
                    });
                    totalAsesores++;
                }
            });
            // Actualizar estad√≠sticas generales en el DOM
            const stats = document.querySelectorAll('#stats-agencia-central .stat-card-general');
            if (stats.length >= 4) {
                stats[0].querySelector('div').textContent = totalClientes;
                stats[1].querySelector('div').textContent = clientesActivos;
                stats[2].querySelector('div').textContent = clientesPerdidos;
                stats[3].querySelector('div').textContent = totalAsesores;
                // Actualizar porcentajes
                stats[1].querySelectorAll('div')[2].textContent = totalClientes > 0 ? ((clientesActivos / totalClientes) * 100).toFixed(1) + '%' : '0%';
                stats[2].querySelectorAll('div')[2].textContent = totalClientes > 0 ? ((clientesPerdidos / totalClientes) * 100).toFixed(1) + '%' : '0%';
            }
            fechaInicio = document.getElementById('fecha-inicio').value;
            fechaFin = document.getElementById('fecha-fin').value;
            
            // Validar que la fecha inicio no sea mayor que la fecha fin
            if (fechaInicio > fechaFin) {
                const temp = fechaInicio;
                fechaInicio = fechaFin;
                fechaFin = temp;
                document.getElementById('fecha-inicio').value = fechaInicio;
                document.getElementById('fecha-fin').value = fechaFin;
            }
            
            // Actualizar la informaci√≥n del rango
            actualizarInfoRango();
            
            // Actualizar la vista actual seg√∫n qu√© est√© mostrado
            const agenciaCentralLink = document.getElementById('agencia-central-link');
            const coopexpressLink = document.getElementById('coopexpress-link');
            
            if (agenciaCentralLink.classList.contains('active')) {
                actualizarPanelAsesores('agencia-central');
                // Si hay un asesor seleccionado, actualizarlo
                const asesorActivo = document.querySelector('.asesor-item.active');
                if (asesorActivo) {
                    const asesorId = asesorActivo.getAttribute('onclick').match(/'([^']+)'/)[1];
                    seleccionarAsesor(asesorId);
                }
            } else if (coopexpressLink.classList.contains('active')) {
                // Si hay una sede seleccionada en Coopexpress, actualizarla
                const sedeActiva = document.querySelector('.sede-item.active');
                if (sedeActiva) {
                    const sedeId = sedeActiva.getAttribute('onclick').match(/'([^']+)'/)[1];
                    seleccionarSede(sedeId);
                    
                    // Si hay un asesor seleccionado dentro de la sede, tambi√©n actualizarlo
                    const asesorActivo = document.querySelector('.asesor-item.active');
                    if (asesorActivo) {
                        const asesorKey = asesorActivo.getAttribute('onclick').match(/'[^']+',\s*'([^']+)'/)[1];
                        seleccionarAsesorCoopexpress(sedeId, asesorKey);
                    }
                } else {
                    // Si no hay sede seleccionada, actualizar la vista general de Coopexpress
                    mostrarCoopexpress();
                }
            }
        }
        
        // Funci√≥n para seleccionar rangos r√°pidos
        function seleccionarRangoRapido(tipo) {
            switch(tipo) {
                case 'semana1':
                    fechaInicio = '2025-09-01';
                    fechaFin = '2025-09-07';
                    break;
                case 'semana2':
                    fechaInicio = '2025-09-08';
                    fechaFin = '2025-09-14';
                    break;
                case 'mes':
                    fechaInicio = '2025-09-01';
                    fechaFin = '2025-09-30';
                    break;
            }
            
            document.getElementById('fecha-inicio').value = fechaInicio;
            document.getElementById('fecha-fin').value = fechaFin;
            aplicarFiltroRango();
        }
        
        // Funci√≥n para actualizar la informaci√≥n del rango
        function actualizarInfoRango() {
            const inicioDate = new Date(fechaInicio + 'T00:00:00');
            const finDate = new Date(fechaFin + 'T00:00:00');
            
            const inicioTexto = inicioDate.toLocaleDateString('es-GT', { day: 'numeric', month: 'long' });
            const finTexto = finDate.toLocaleDateString('es-GT', { day: 'numeric', month: 'long', year: 'numeric' });
            
            let mensaje;
            if (fechaInicio === fechaFin) {
                mensaje = `üìä Mostrando datos del ${inicioTexto}`;
            } else if (fechaInicio === '2025-09-01' && fechaFin === '2025-09-30') {
                mensaje = `üìä Mostrando datos de todo septiembre (1 - 30 septiembre 2025)`;
            } else {
                mensaje = `üìä Mostrando datos del ${inicioTexto} al ${finTexto}`;
            }
            
            document.getElementById('rango-info').innerHTML = mensaje;
        }
        
        // Funci√≥n para mostrar notificaci√≥n temporal
        function mostrarNotificacionFiltro(mensaje) {
            // Remover notificaci√≥n existente si la hay
            const existente = document.querySelector('.notificacion-filtro');
            if (existente) existente.remove();
            
            const notificacion = document.createElement('div');
            notificacion.className = 'notificacion-filtro';
            notificacion.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #ff7f00, #ff9500);
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(255, 127, 0, 0.3);
                z-index: 1000;
                font-weight: 600;
                animation: slideIn 0.3s ease;
            `;
            notificacion.textContent = mensaje;
            
            document.body.appendChild(notificacion);
            
            // Remover despu√©s de 3 segundos
            setTimeout(() => {
                if (notificacion.parentNode) {
                    notificacion.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notificacion.remove(), 300);
                }
            }, 3000);
        }
        
        // Funci√≥n para obtener datos filtrados por fecha
        function obtenerDatosFiltrados(datosAsesor) {
            // Si no hay datos por fecha, retornar los datos generales
            if (!datosAsesor.porFecha) {
                return datosAsesor;
            }
            
            // Generar lista de fechas en el rango
            const fechasEnRango = [];
            const inicio = new Date(fechaInicio + 'T00:00:00');
            const fin = new Date(fechaFin + 'T00:00:00');
            
            for (let fecha = new Date(inicio); fecha <= fin; fecha.setDate(fecha.getDate() + 1)) {
                const fechaStr = fecha.toISOString().split('T')[0];
                fechasEnRango.push(fechaStr);
            }
            
            // Inicializar contadores para el rango
            let totalClientes = 0;
            let clientesActivos = 0;
            let clientesPerdidos = 0;
            let etapasSum = {};
            let medioGeneradorSum = {};
            let origenSum = { asesor: 0, ia: 0 };
            let hayDatos = false;
            
            // Sumar datos de todas las fechas en el rango
            fechasEnRango.forEach(fecha => {
                const datosFecha = datosAsesor.porFecha[fecha];
                if (datosFecha && !datosFecha.sinDatos) {
                    hayDatos = true;
                    totalClientes += datosFecha.totalClientes || 0;
                    clientesActivos += datosFecha.clientesActivos || 0;
                    clientesPerdidos += datosFecha.clientesPerdidos || 0;
                    
                    // Sumar etapas
                    if (datosFecha.etapas) {
                        Object.keys(datosFecha.etapas).forEach(etapa => {
                            etapasSum[etapa] = (etapasSum[etapa] || 0) + (datosFecha.etapas[etapa] || 0);
                        });
                    }
                    
                    // Sumar medios generadores
                    if (datosFecha.medioGenerador) {
                        Object.keys(datosFecha.medioGenerador).forEach(medio => {
                            medioGeneradorSum[medio] = (medioGeneradorSum[medio] || 0) + (datosFecha.medioGenerador[medio] || 0);
                        });
                    }
                    
                    // Sumar origen
                    if (datosFecha.origen) {
                        origenSum.asesor += datosFecha.origen.asesor || 0;
                        origenSum.ia += datosFecha.origen.ia || 0;
                    }
                }
            });
            
            // Si no hay datos en el rango, retornar datos vac√≠os
            if (!hayDatos) {
                return {
                    ...datosAsesor,
                    totalClientes: 0,
                    clientesActivos: 0,
                    clientesPerdidos: 0,
                    etapas: {},
                    medioGenerador: {},
                    origen: { asesor: 0, ia: 0 },
                    sinDatos: true
                };
            }
            
            return {
                ...datosAsesor,
                totalClientes,
                clientesActivos,
                clientesPerdidos,
                etapas: etapasSum,
                medioGenerador: medioGeneradorSum,
                origen: origenSum,
                sinDatos: false
            };
        }
        
        // Base de datos de asesores
        const asesoresData = {
            miguel: {
                nombre: "Miguel",
                totalClientes: 35,
                clientesActivos: 34,
                clientesPerdidos: 1,
                etapas: {
                    prospecto: 10,
                    oportunidad: 4,
                    negociacion: 3,
                    comite: 1,
                    leads: 13
                },
                medioGenerador: {
                    social_manager: 13,
                    sitio_web: 1,
                    whatsapp: 13,
                    referido: 1,
                    facebook: 2,
                    pbx: 1
                },
                origen: {
                    asesor: 17,
                    ia: 14
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                        '2025-09-25': {
                            totalClientes: 3,
                            clientesActivos: 3,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1, leads: 2 },
                            medioGenerador: { sitio_web: 1, social_manager: 1, facebook: 1 },
                            origen: { asesor: 2, ia: 1 },
                            detalle: [
                                { etapa: 'OPORTUNIDAD', estado: 'ACTIVO', medio: 'SITIO WEB', origen: 'ASESOR' },
                                { etapa: 'LEADS', estado: 'ACTIVO', medio: 'SOCIAL MANAGER', origen: 'ASESOR' },
                                { etapa: 'LEADS', estado: 'ACTIVO', medio: 'FACEBOOK', origen: 'IA' }
                            ]
                        },
                    '2025-09-01': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1, leads: 2 },
                        medioGenerador: { social_manager: 1, whatsapp: 2 },
                        origen: { asesor: 1, ia: 2 }
                    },
                    '2025-09-02': {
                        totalClientes: 4,
                        clientesActivos: 4,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 3, negociacion: 1 },
                        medioGenerador: { social_manager: 1, whatsapp: 3 },
                        origen: { asesor: 1, ia: 3 }
                    },
                    '2025-09-03': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { comite: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-08': {
                        totalClientes: 4,
                        clientesActivos: 4,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 3, oportunidad: 1, leads: 1 },
                        medioGenerador: { sitio_web: 1, social_manager: 2, referido: 1, whatsapp: 1 },
                        origen: { asesor: 4, ia: 1 }
                    },
                    '2025-09-09': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { negociacion: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-10': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 1 },
                        medioGenerador: { social_manager: 2 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-11': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 2 },
                        origen: { ia: 2, asesor: 0 }
                    },
                    '2025-09-16': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-17': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-18': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-19': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-21': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { referido: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-22': {
                        totalClientes: 4,
                        clientesActivos: 4,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 3 },
                        medioGenerador: { social_manager: 1, whatsapp: 3 },
                        origen: { asesor: 1, ia: 3 }
                    },
                    '2025-09-23': {
                        totalClientes: 4,
                        clientesActivos: 3,
                        clientesPerdidos: 1,
                        etapas: { prospecto: 1, oportunidad: 1, leads: 2 },
                        medioGenerador: { social_manager: 2, facebook: 2 },
                        origen: { asesor: 3, ia: 1 }
                    },
                    '2025-09-24': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1 },
                        medioGenerador: { pbx: 1 },
                        origen: { asesor: 1, ia: 0 }
                    }
                }
            },
            emely: {
                nombre: "Emely",
                totalClientes: 24,
                clientesActivos: 18,
                clientesPerdidos: 6,
                etapas: {
                    prospecto: 0,
                    oportunidad: 4,
                    negociacion: 1,
                    comite: 0,
                    leads: 15,
                    desembolso: 0,
                    desembolsado: 0,
                    reconsideracion: 1
                },
                medioGenerador: {
                    social_manager: 14,
                    whatsapp: 4,
                    facebook: 1,
                    pbx: 1,
                    referido: 1,
                    sitio_web: 0,
                    visita_oficina: 0
                },
                origen: {
                    asesor: 17,
                    ia: 4
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                        '2025-09-25': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { leads: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { ia: 1, asesor: 0 }
                        },
                    '2025-09-01': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { reconsideracion: 1, leads: 2 },
                        medioGenerador: { whatsapp: 1, social_manager: 2 },
                        origen: { ia: 1, asesor: 2 }
                    },
                    '2025-09-03': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { leads: 3 },
                        medioGenerador: { social_manager: 1, whatsapp: 2 },
                        origen: { asesor: 1, ia: 2 }
                    },
                    '2025-09-05': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1 },
                        medioGenerador: { referido: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-08': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { negociacion: 1, oportunidad: 1 },
                        medioGenerador: { pbx: 1, social_manager: 1 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-11': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-17': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1, leads: 2 },
                        medioGenerador: { facebook: 1, social_manager: 2 },
                        origen: { asesor: 3, ia: 0 }
                    },
                    '2025-09-18': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-22': {
                        totalClientes: 3,
                        clientesActivos: 2,
                        clientesPerdidos: 1,
                        etapas: { leads: 3 },
                        medioGenerador: { social_manager: 3 },
                        origen: { asesor: 3, ia: 0 }
                    },
                    '2025-09-23': {
                        totalClientes: 2,
                        clientesActivos: 1,
                        clientesPerdidos: 1,
                        etapas: { leads: 2 },
                        medioGenerador: { social_manager: 2 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-24': {
                        totalClientes: 2,
                        clientesActivos: 1,
                        clientesPerdidos: 1,
                        etapas: { oportunidad: 1, leads: 1 },
                        medioGenerador: { social_manager: 2 },
                        origen: { asesor: 2, ia: 0 }
                    }
                }
            },
            gabriel: {
                nombre: "Gabriel",
                totalClientes: 22,
                clientesActivos: 20,
                clientesPerdidos: 2,
                etapas: {
                    prospecto: 0,
                    oportunidad: 2,
                    negociacion: 0,
                    comite: 0,
                    leads: 18,
                    desembolso: 0,
                    desembolsado: 0,
                    reconsideracion: 0
                },
                medioGenerador: {
                    whatsapp: 14,
                    social_manager: 3,
                    facebook: 3,
                    sitio_web: 0,
                    pbx: 0,
                    referido: 0,
                    visita_oficina: 0
                },
                origen: {
                        asesor: 6,
                        ia: 0
                    },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                        '2025-09-25': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { leads: 1 },
                            medioGenerador: { facebook: 1 },
                            origen: { ia: 1, asesor: 0 }
                        },
                    '2025-09-01': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-02': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-03': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 1, sitio_web: 1 },
                        origen: { ia: 2, asesor: 0 }
                    },
                    '2025-09-05': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-10': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1, leads: 1 },
                        medioGenerador: { whatsapp: 2 },
                        origen: { ia: 2, asesor: 0 }
                    },
                    '2025-09-11': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 2 },
                        origen: { ia: 2, asesor: 0 }
                    },
                    '2025-09-12': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { facebook: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-13': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-16': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-17': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { social_manager: 2 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-18': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 1, social_manager: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-19': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 2 },
                        origen: { ia: 2, asesor: 0 }
                    },
                    '2025-09-21': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-22': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { leads: 3 },
                        medioGenerador: { facebook: 1, whatsapp: 2 },
                        origen: { asesor: 0, ia: 3 }
                    },
                    '2025-09-23': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { facebook: 1 },
                        origen: { asesor: 0, ia: 1 }
                    }
                }
            },
            brayan: {
                nombre: "Brayan",
                totalClientes: 33,
                clientesActivos: 31,
                clientesPerdidos: 2,
                etapas: {
                    prospecto: 5,
                    oportunidad: 3,
                    negociacion: 0,
                    comite: 0,
                    leads: 20,
                    desembolso: 1,
                    desembolsado: 1
                },
                medioGenerador: {
                    social_manager: 9,
                    whatsapp: 8,
                    pbx: 6,
                    sitio_web: 2,
                    referido: 1,
                    visita_oficina: 1,
                    facebook: 4
                },
                origen: {
                    asesor: 22,
                    ia: 8
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                        '2025-09-25': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 },
                            detalle: [
                                { etapa: 'PROSPECTO', estado: 'ACTIVO', medio: 'SOCIAL MANAGER', origen: 'ASESOR' }
                            ]
                        },
                    '2025-09-02': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { desembolsado: 1, leads: 1 },
                        medioGenerador: { pbx: 1, social_manager: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-03': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { pbx: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-04': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { desembolsado: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-05': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { desembolso: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-06': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-09': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-10': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 2 },
                        medioGenerador: { pbx: 1, visita_oficina: 1 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-11': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-12': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 1, pbx: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-15': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { sitio_web: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-16': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { sitio_web: 1, social_manager: 1 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-17': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-18': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 1 },
                        medioGenerador: { sitio_web: 1, referido: 1 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-19': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { leads: 3 },
                        medioGenerador: { whatsapp: 3 },
                        origen: { asesor: 1, ia: 2 }
                    },
                    '2025-09-22': {
                        totalClientes: 2,
                        clientesActivos: 1,
                        clientesPerdidos: 1,
                        etapas: { oportunidad: 1, leads: 1 },
                        medioGenerador: { social_manager: 2 },
                        origen: { asesor: 2, ia: 0 }
                    },
                    '2025-09-23': {
                        totalClientes: 3,
                        clientesActivos: 3,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 2 },
                        medioGenerador: { pbx: 1, facebook: 2 },
                        origen: { asesor: 1, ia: 2 }
                    },
                    '2025-09-24': {
                        totalClientes: 5,
                        clientesActivos: 4,
                        clientesPerdidos: 1,
                        etapas: { prospecto: 3, leads: 2 },
                        medioGenerador: { facebook: 2, pbx: 2, social_manager: 1 },
                        origen: { asesor: 4, ia: 1 }
                    }
                }
            },
            rudy: {
                nombre: "Rudy",
                totalClientes: 13,
                clientesActivos: 13,
                clientesPerdidos: 0,
                etapas: {
                    prospecto: 2,
                    oportunidad: 4,
                    negociacion: 1,
                    comite: 0,
                    leads: 4,
                    desembolso: 0,
                    desembolsado: 0,
                    reconsideracion: 2
                },
                medioGenerador: {
                    whatsapp: 7,
                    social_manager: 3,
                    pbx: 2,
                    facebook: 1,
                    sitio_web: 0,
                    referido: 0,
                    visita_oficina: 0
                },
                origen: {
                    asesor: 5,
                    ia: 8
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                    '2025-09-01': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { reconsideracion: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-05': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { reconsideracion: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-08': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1, negociacion: 1 },
                        medioGenerador: { whatsapp: 1, pbx: 1 },
                        origen: { ia: 1, asesor: 1 }
                    },
                    '2025-09-09': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-12': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-18': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 1 },
                        medioGenerador: { social_manager: 1, whatsapp: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-19': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-21': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 2 },
                        origen: { ia: 2, asesor: 0 }
                    },
                    '2025-09-24': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 2 },
                        medioGenerador: { facebook: 1, pbx: 1 },
                        origen: { ia: 1, asesor: 1 }
                    }
                }
            },
            jorge: {
                nombre: "Jorge",
                totalClientes: 20,
                clientesActivos: 20,
                clientesPerdidos: 0,
                etapas: {
                    prospecto: 4,
                    oportunidad: 2,
                    negociacion: 0,
                    comite: 0,
                    leads: 12,
                    desembolso: 0,
                    desembolsado: 0,
                    reconsideracion: 0
                },
                medioGenerador: {
                    whatsapp: 8,
                    facebook: 5,
                    social_manager: 5,
                    sitio_web: 0,
                    pbx: 0,
                    referido: 0,
                    visita_oficina: 0
                },
                origen: {
                    asesor: 7,
                    ia: 11
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                        '2025-09-25': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 },
                            detalle: [
                                { etapa: 'PROSPECTO', estado: 'ACTIVO', medio: 'SOCIAL MANAGER', origen: 'ASESOR' }
                            ]
                        },
                    '2025-09-02': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-09': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { facebook: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-11': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-13': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-17': {
                        totalClientes: 6,
                        clientesActivos: 6,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 2, oportunidad: 1, leads: 3 },
                        medioGenerador: { whatsapp: 1, social_manager: 5 },
                        origen: { asesor: 6, ia: 0 }
                    },
                    '2025-09-18': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 1 },
                        medioGenerador: { whatsapp: 1, social_manager: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-19': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-22': {
                        totalClientes: 2,
                        clientesActivos: 2,
                        clientesPerdidos: 0,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 2 },
                        origen: { asesor: 0, ia: 2 }
                    },
                    '2025-09-23': {
                        totalClientes: 4,
                        clientesActivos: 4,
                        clientesPerdidos: 0,
                        etapas: { prospecto: 1, leads: 3 },
                        medioGenerador: { facebook: 4 },
                        origen: { asesor: 0, ia: 4 }
                    }
                }
            },
            carlos: {
                nombre: "Carlos",
                totalClientes: 26,
                clientesActivos: 23,
                clientesPerdidos: 3,
                etapas: {
                    prospecto: 0,
                    oportunidad: 7,
                    negociacion: 1,
                    comite: 2,
                    leads: 20,
                    desembolso: 0,
                    desembolsado: 0
                },
                medioGenerador: {
                    social_manager: 9,
                    whatsapp: 12,
                    facebook: 4,
                    pbx: 3,
                    sitio_web: 0,
                    referido: 2,
                    visita_oficina: 0
                },
                origen: {
                    asesor: 14,
                    ia: 16
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                        '2025-09-25': {
                            totalClientes: 3,
                            clientesActivos: 0,
                            clientesPerdidos: 3,
                            etapas: { leads: 3 },
                            medioGenerador: { social_manager: 2, facebook: 1 },
                            origen: { asesor: 0, ia: 3 },
                            detalle: [
                                { etapa: 'LEADS', estado: 'PERDIDO', medio: 'SOCIAL MANAGER', origen: 'IA' },
                                { etapa: 'LEADS', estado: 'PERDIDO', medio: 'SOCIAL MANAGER', origen: 'IA' },
                                { etapa: 'LEADS', estado: 'PERDIDO', medio: 'FACEBOOK', origen: 'IA' }
                            ]
                        },
                    '2025-09-08': {
                        totalClientes: 36,
                        clientesActivos: 35,
                        clientesPerdidos: 1,
                        etapas: { oportunidad: 1, comite: 1, leads: 1 },
                        medioGenerador: { pbx: 1, social_manager: 2 },
                        origen: { asesor: 3, ia: 0 }
                    },
                    '2025-09-09': {
                        totalClientes: 23,
                        clientesActivos: 18,
                        clientesPerdidos: 5,
                        etapas: { oportunidad: 1, leads: 1 },
                        medioGenerador: { social_manager: 1, facebook: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-16': {
                        totalClientes: 22,
                        clientesActivos: 19,
                        clientesPerdidos: 3,
                        etapas: { leads: 2 },
                        medioGenerador: { social_manager: 1, whatsapp: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-18': {
                        totalClientes: 34,
                        clientesActivos: 32,
                        clientesPerdidos: 2,
                        etapas: { leads: 2 },
                        medioGenerador: { whatsapp: 1, referido: 1 },
                        origen: { asesor: 1, ia: 1 }
                    },
                    '2025-09-19': {
                        totalClientes: 4,
                        clientesActivos: 4,
                        clientesPerdidos: 0,
                        etapas: { oportunidad: 1, leads: 3 },
                        medioGenerador: { pbx: 1, whatsapp: 3 },
                        origen: { asesor: 1, ia: 3 }
                    },
                    '2025-09-20': {
                        totalClientes: 13,
                        clientesActivos: 13,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { referido: 1 },
                        origen: { asesor: 1, ia: 0 }
                    },
                    '2025-09-21': {
                        totalClientes: 20,
                        clientesActivos: 20,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { whatsapp: 1 },
                        origen: { ia: 1, asesor: 0 }
                    },
                    '2025-09-22': {
                        totalClientes: 4,
                        clientesActivos: 3,
                        clientesPerdidos: 1,
                        etapas: { oportunidad: 1, leads: 3 },
                        medioGenerador: { pbx: 1, whatsapp: 3 },
                        origen: { asesor: 1, ia: 3 }
                    },
                    '2025-09-23': {
                        totalClientes: 4,
                        clientesActivos: 4,
                        clientesPerdidos: 0,
                        etapas: { leads: 4 },
                        medioGenerador: { facebook: 3, social_manager: 1 },
                        origen: { asesor: 1, ia: 3 }
                    },
                    '2025-09-24': {
                        totalClientes: 34,
                        clientesActivos: 31,
                        clientesPerdidos: 3,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    }
                }
            },
            kevin: {
                nombre: "Kevin",
                totalClientes: 1,
                clientesActivos: 1,
                clientesPerdidos: 0,
                etapas: {
                    prospecto: 0,
                    oportunidad: 0,
                    negociacion: 0,
                    comite: 0,
                    leads: 1,
                    desembolso: 0,
                    desembolsado: 0,
                    reconsideracion: 0
                },
                medioGenerador: {
                    social_manager: 1,
                    whatsapp: 0,
                    facebook: 0,
                    sitio_web: 0,
                    pbx: 0,
                    referido: 0,
                    visita_oficina: 0
                },
                origen: {
                    asesor: 1,
                    ia: 0
                },
                // Datos reales por fecha basados en tu tabla
                porFecha: {
                    '2025-09-01': {
                        totalClientes: 1,
                        clientesActivos: 1,
                        clientesPerdidos: 0,
                        etapas: { leads: 1 },
                        medioGenerador: { social_manager: 1 },
                        origen: { asesor: 1, ia: 0 }
                    }
                        ,
                        // ...existing code...
                }
            }
        };

        // Datos de Coopexpress por sede y asesor
        const coopexpressData = {
            escuintla: {
                // Totales de la sede completa (Anahi + M√≥nica)
                totalSede: {
                    totalClientes: 48,
                    clientesActivos: 34,
                    clientesPerdidos: 14
                },
                // Datos individuales de Anahi (parte de los totales de Escuintla)
                anahi: {
                    nombre: "Anahi",
                    totalClientes: 37, // Total casos de Anahi incluyendo el de Rigoberto + 3 nuevos
                    clientesActivos: 23, // 20 + 3 nuevos activos
                    clientesPerdidos: 14,
                    etapas: {
                        prospecto: 9,
                        oportunidad: 6, // 5 + 1 nueva
                        negociacion: 1,
                        comite: 1,
                        leads: 6, // 4 + 2 nuevos
                        desembolso: 1,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 36, // 34 + 2 nuevos
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 2,
                        referido: 0,
                        visita_oficina: 3, // 2 + 1 nueva
                        voxia_ia: 1
                    },
                    origen: {
                        asesor: 37, // 34 + 3 nuevos
                        ia: 0
                    },
                    // Datos reales por fecha basados en tu tabla
                    porFecha: {
                        '2025-09-01': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { desembolso: 1 },
                            medioGenerador: { pbx: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-02': {
                            totalClientes: 2,
                            clientesActivos: 1,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 1, leads: 1 },
                            medioGenerador: { social_manager: 2 },
                            origen: { asesor: 2, ia: 0 }
                        },
                        '2025-09-03': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-05': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { visita_oficina: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-08': {
                            totalClientes: 2, // 1 de Anahi + 1 de Rigoberto
                            clientesActivos: 2,
                            clientesPerdidos: 0,
                            etapas: { leads: 2 }, // 1 de Anahi + 1 de Rigoberto
                            medioGenerador: { social_manager: 2 }, // Ambos social manager
                            origen: { asesor: 2, ia: 0 } // Ambos asesor
                        },
                        '2025-09-09': {
                            totalClientes: 3,
                            clientesActivos: 1,
                            clientesPerdidos: 2,
                            etapas: { prospecto: 1, oportunidad: 2 },
                            medioGenerador: { social_manager: 3 },
                            origen: { asesor: 3, ia: 0 }
                        },
                        '2025-09-10': {
                            totalClientes: 2,
                            clientesActivos: 1,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 2 },
                            medioGenerador: { social_manager: 1, pbx: 1 },
                            origen: { asesor: 2, ia: 0 }
                        },
                        '2025-09-11': {
                            totalClientes: 4,
                            clientesActivos: 4,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 3, leads: 1 },
                            medioGenerador: { social_manager: 4 },
                            origen: { asesor: 4, ia: 0 }
                        },
                        '2025-09-12': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { comite: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-16': {
                            totalClientes: 4,
                            clientesActivos: 4,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 2, oportunidad: 2 },
                            medioGenerador: { social_manager: 4 },
                            origen: { asesor: 4, ia: 0 }
                        },
                        '2025-09-17': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { negociacion: 1 },
                            medioGenerador: { visita_oficina: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-18': {
                            totalClientes: 2,
                            clientesActivos: 2,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1, oportunidad: 1 },
                            medioGenerador: { social_manager: 2 },
                            origen: { asesor: 2, ia: 0 }
                        },
                        '2025-09-19': {
                            totalClientes: 2,
                            clientesActivos: 1,
                            clientesPerdidos: 1,
                            etapas: { prospecto: 1, leads: 1 },
                            medioGenerador: { social_manager: 1, voxia_ia: 1 },
                            origen: { asesor: 1, ia: 1 }
                        },
                        '2025-09-22': {
                            totalClientes: 3,
                            clientesActivos: 3,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1, leads: 2 },
                            medioGenerador: { social_manager: 2, visita_oficina: 1 },
                            origen: { asesor: 3, ia: 0 }
                        }
                            ,
                            '2025-09-25': {
                                totalClientes: 1,
                                clientesActivos: 1,
                                clientesPerdidos: 0,
                                etapas: { oportunidad: 1 },
                                medioGenerador: { social_manager: 1 },
                                origen: { asesor: 1, ia: 0 }
                            }
                    }
                },
                // Datos individuales de Monica
                monica: {
                    nombre: "Monica",
                    totalClientes: 7, // Total casos de M√≥nica + 1 nuevo del 23-sep
                    clientesActivos: 4, // 3 + 1 nuevo activo
                    clientesPerdidos: 3, // Sin cambio
                    etapas: {
                        prospecto: 2, // 1 + 1 nuevo prospecto
                        oportunidad: 3, // Sin cambio
                        negociacion: 0,
                        comite: 0,
                        leads: 2, // Sin cambio
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 7, // 6 + 1 nuevo
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 7, // 6 + 1 nuevo
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-03': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-04': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-08': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-22': {
                            totalClientes: 3,
                            clientesActivos: 2,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 1, leads: 2 },
                            medioGenerador: { social_manager: 3 },
                            origen: { asesor: 3, ia: 0 }
                        },
                        '2025-09-23': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        }
                            ,
                            '2025-09-25': {
                                totalClientes: 3,
                                clientesActivos: 2,
                                clientesPerdidos: 1,
                                etapas: { leads: 2 },
                                medioGenerador: { social_manager: 3 },
                                origen: { asesor: 3, ia: 0 }
                            }
                    }
                }
            },
            coban: {
                // DATOS ACTUALIZADOS SEG√öN LISTA DEL USUARIO PARA SEPTIEMBRE
                totalSede: {
                    totalClientes: 72,
                    clientesActivos: 61,
                    clientesPerdidos: 11
                },
                jennifer: {
                    nombre: "Jennifer",
                    totalClientes: 4,
                    clientesActivos: 4,
                    clientesPerdidos: 0,
                    etapas: {
                        prospecto: 0,
                        oportunidad: 4,
                        negociacion: 0,
                        comite: 0,
                        leads: 0,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 2,
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 2
                    },
                    origen: {
                        asesor: 4,
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-08': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { oportunidad: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-15': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { oportunidad: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-17': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { leads: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-18': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { oportunidad: 1 }, medioGenerador: { visita_oficina: 1 }, origen: { asesor: 1 } }
                    }
                },
                lidia: {
                    nombre: "Lidia",
                    totalClientes: 1,
                    clientesActivos: 1,
                    clientesPerdidos: 0,
                    etapas: {
                        prospecto: 0,
                        oportunidad: 0,
                        negociacion: 0,
                        comite: 0,
                        leads: 1,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 1,
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 1,
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { leads: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } }
                    }
                },
                mildred: {
                    nombre: "Mildred",
                    totalClientes: 67,
                    clientesActivos: 56,
                    clientesPerdidos: 11,
                    etapas: {
                        prospecto: 13,
                        oportunidad: 25,
                        negociacion: 1,
                        comite: 2,
                        leads: 26,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 53,
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 4,
                        referido: 3,
                        visita_oficina: 7,
                        llamada: 1
                    },
                    origen: {
                        asesor: 67,
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': { totalClientes: 2, clientesActivos: 1, clientesPerdidos: 1, etapas: { leads: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-02': { totalClientes: 2, clientesActivos: 1, clientesPerdidos: 1, etapas: { prospecto: 1, oportunidad: 1 }, medioGenerador: { social_manager: 1, visita_oficina: 1 }, origen: { asesor: 2 } },
                        '2025-09-03': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { negociacion: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-05': { totalClientes: 4, clientesActivos: 2, clientesPerdidos: 2, etapas: { oportunidad: 4 }, medioGenerador: { visita_oficina: 4 }, origen: { asesor: 4 } },
                        '2025-09-06': { totalClientes: 3, clientesActivos: 2, clientesPerdidos: 1, etapas: { oportunidad: 3 }, medioGenerador: { social_manager: 1, visita_oficina: 2 }, origen: { asesor: 3 } },
                        '2025-09-08': { totalClientes: 7, clientesActivos: 6, clientesPerdidos: 1, etapas: { leads: 7 }, medioGenerador: { social_manager: 7 }, origen: { asesor: 7 } },
                        '2025-09-09': { totalClientes: 2, clientesActivos: 2, clientesPerdidos: 0, etapas: { oportunidad: 2 }, medioGenerador: { social_manager: 1, visita_oficina: 1 }, origen: { asesor: 2 } },
                        '2025-09-10': { totalClientes: 6, clientesActivos: 5, clientesPerdidos: 1, etapas: { oportunidad: 4, leads: 2 }, medioGenerador: { social_manager: 2, visita_oficina: 2, pbx: 1 }, origen: { asesor: 6 } },
                        '2025-09-11': { totalClientes: 6, clientesActivos: 4, clientesPerdidos: 2, etapas: { oportunidad: 3, prospecto: 1, leads: 2 }, medioGenerador: { social_manager: 4, visita_oficina: 1 }, origen: { asesor: 6 } },
                        '2025-09-13': { totalClientes: 2, clientesActivos: 2, clientesPerdidos: 0, etapas: { oportunidad: 2 }, medioGenerador: { social_manager: 2 }, origen: { asesor: 2 } },
                        '2025-09-14': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { prospecto: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-16': { totalClientes: 3, clientesActivos: 3, clientesPerdidos: 0, etapas: { prospecto: 1, oportunidad: 1, leads: 1 }, medioGenerador: { social_manager: 2, referido: 1 }, origen: { asesor: 3 } },
                        '2025-09-17': { totalClientes: 4, clientesActivos: 4, clientesPerdidos: 0, etapas: { oportunidad: 2, prospecto: 1, leads: 1 }, medioGenerador: { pbx: 2, social_manager: 2 }, origen: { asesor: 4 } },
                        '2025-09-18': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { oportunidad: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-19': { totalClientes: 4, clientesActivos: 4, clientesPerdidos: 0, etapas: { oportunidad: 2, prospecto: 1, leads: 1 }, medioGenerador: { social_manager: 3, llamada: 1 }, origen: { asesor: 4 } },
                        '2025-09-20': { totalClientes: 5, clientesActivos: 5, clientesPerdidos: 0, etapas: { oportunidad: 3, prospecto: 1, leads: 1 }, medioGenerador: { social_manager: 3, visita_oficina: 1, referido: 1 }, origen: { asesor: 5 } },
                        '2025-09-21': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { leads: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-22': { totalClientes: 6, clientesActivos: 6, clientesPerdidos: 0, etapas: { oportunidad: 3, prospecto: 2, leads: 1 }, medioGenerador: { social_manager: 5, visita_oficina: 2 }, origen: { asesor: 6 } },
                        '2025-09-23': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { prospecto: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } },
                        '2025-09-24': { totalClientes: 4, clientesActivos: 4, clientesPerdidos: 0, etapas: { oportunidad: 1, prospecto: 3 }, medioGenerador: { social_manager: 4 }, origen: { asesor: 4 } }
                            ,
                            '2025-09-25': { totalClientes: 1, clientesActivos: 1, clientesPerdidos: 0, etapas: { prospecto: 1 }, medioGenerador: { social_manager: 1 }, origen: { asesor: 1 } }
                    }
                }
            },
            '4caminos': {
                // Totales de la sede 4 Caminos seg√∫n datos Excel
                totalSede: {
                    totalClientes: 17,
                    clientesActivos: 15,
                    clientesPerdidos: 2
                },
                // Datos individuales de Andony
                andony: {
                    nombre: "Andony",
                    totalClientes: 9, // 8 + 1 nuevo del 24-sep
                    clientesActivos: 9, // 8 + 1 nuevo activo
                    clientesPerdidos: 0, // Ninguno perdido
                    etapas: {
                        prospecto: 0,
                        oportunidad: 9, // 8 + 1 nueva
                        negociacion: 0,
                        comite: 0,
                        leads: 0,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 9, // 8 + 1 nuevo
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 8, // 7 + 1 nuevo
                        ia: 1 // Sin cambio
                    },
                    porFecha: {
                        '2025-09-01': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-02': { sinDatos: true },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': { sinDatos: true },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': { sinDatos: true },
                        '2025-09-09': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { whatsapp: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': { sinDatos: true },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': { sinDatos: true },
                        '2025-09-16': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-17': { sinDatos: true },
                        '2025-09-18': { sinDatos: true },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 0, ia: 1 }
                        },
                        '2025-09-23': {
                            totalClientes: 2,
                            clientesActivos: 2,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 2 },
                            medioGenerador: { social_manager: 2 },
                            origen: { asesor: 2, ia: 0 }
                        },
                        '2025-09-24': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                },
                // Datos individuales de Brandon
                brandon: {
                    nombre: "Brandon",
                    totalClientes: 3, // 2 anteriores + 1 nuevo del 25-sep
                    clientesActivos: 2, // 1 anterior + 1 nuevo activo del 25-sep
                    clientesPerdidos: 1, // 1 perdido
                    etapas: {
                        prospecto: 0,
                        oportunidad: 2, // 03-sep (activo) + 08-sep (perdido)
                        negociacion: 0,
                        comite: 0,
                        leads: 0,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 2, // Ambos casos por social manager
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 2, // Ambos casos por asesor seg√∫n Excel
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': { sinDatos: true },
                        '2025-09-02': { sinDatos: true },
                        '2025-09-03': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-04': { sinDatos: true },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': { sinDatos: true },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': { sinDatos: true },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-25': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1, ia: 0 }
                        },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                },
                // Datos individuales de Jorge
                jorge: {
                    nombre: "Jorge",
                    totalClientes: 4, // Total casos seg√∫n Excel
                    clientesActivos: 3, // 3 activos
                    clientesPerdidos: 1, // 1 perdido (09-sep)
                    etapas: {
                        prospecto: 0,
                        oportunidad: 2, // 11-sep (activo) + 09-sep (perdido)
                        negociacion: 0,
                        comite: 1, // 01-sep (activo)
                        leads: 1, // 06-sep (activo)
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 1, // 09-sep (perdido)
                        whatsapp: 3, // 11-sep, 01-sep, 06-sep
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 1, // 09-sep (perdido)
                        ia: 3 // 11-sep, 01-sep, 06-sep
                    },
                    porFecha: {
                        '2025-09-01': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { comite: 1 },
                            medioGenerador: { whatsapp: 1 },
                            origen: { ia: 1 }
                        },
                        '2025-09-02': { sinDatos: true },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': { sinDatos: true },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { leads: 1 },
                            medioGenerador: { whatsapp: 1 },
                            origen: { ia: 1 }
                        },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                            
                        },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': { sinDatos: true },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': { sinDatos: true },
                        '2025-09-16': { sinDatos: true },
                        '2025-09-17': { sinDatos: true },
                        '2025-09-18': { sinDatos: true },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': { sinDatos: true },
                        '2025-09-23': { sinDatos: true },
                        '2025-09-24': { sinDatos: true },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                }
            },
            'peten': {
                // Totales de la sede Pet√©n (Elizabeth + Oswaldo)
                totalSede: {
                    totalClientes: 10, // 9 + 1 nuevo caso de Oswaldo
                    clientesActivos: 8, // 7 + 1 nuevo activo de Oswaldo
                    clientesPerdidos: 2 // Sin cambio (Oswaldo 18-sep desembolso, 04-sep comit√©)
                },
                // Datos individuales de Elizabeth
                elizabeth: {
                    nombre: "Elizabeth",
                    totalClientes: 2, // Total casos de Elizabeth seg√∫n tabla
                    clientesActivos: 2, // Ambos activos
                    clientesPerdidos: 0, // Ninguno perdido
                    etapas: {
                        prospecto: 0,
                        oportunidad: 1, // 02-sep
                        negociacion: 0,
                        comite: 1, // 06-sep
                        leads: 0,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 2, // Ambos casos son SOCIAL MANAGER
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 2, // Ambos gestionados por asesor
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': { sinDatos: true },
                        '2025-09-02': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': { sinDatos: true },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { comite: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': { sinDatos: true },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': { sinDatos: true },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': { sinDatos: true },
                        '2025-09-16': { sinDatos: true },
                        '2025-09-17': { sinDatos: true },
                        '2025-09-18': { sinDatos: true },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': { sinDatos: true },
                        '2025-09-23': { sinDatos: true },
                        '2025-09-24': { sinDatos: true },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                },
                // Datos individuales de Oswaldo
                oswaldo: {
                    nombre: "Oswaldo",
                    totalClientes: 8, // 7 + 1 nuevo caso
                    clientesActivos: 6, // 5 + 1 nuevo activo
                    clientesPerdidos: 2, // Sin cambio (18-sep desembolso, 04-sep comit√©)
                    etapas: {
                        prospecto: 6, // 5 + 1 nuevo
                        oportunidad: 0,
                        negociacion: 0,
                        comite: 1, // 04-sep (perdido)
                        leads: 0,
                        desembolso: 1, // 18-sep (perdido)
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 4, // CARLOS ORTIZ, DALILA SOLIS, IDIDA RUTH, RUDI ANTONIO
                        whatsapp: 0,
                        facebook: 1, // 1 nuevo por facebook
                        sitio_web: 0,
                        pbx: 0,
                        referido: 3, // Guisela pacheco, GERSON SAMUEL, RONY VILIALDO
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 7, // Sin cambio
                        ia: 1 // 1 nuevo por IA
                    },
                    porFecha: {
                        '2025-09-01': { sinDatos: true },
                        '2025-09-02': { sinDatos: true },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': {
                            totalClientes: 1,
                            clientesActivos: 0,
                            clientesPerdidos: 1,
                            etapas: { comite: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': { sinDatos: true },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': { sinDatos: true },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': { sinDatos: true },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { referido: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-16': { sinDatos: true },
                        '2025-09-17': { sinDatos: true },
                        '2025-09-18': {
                            totalClientes: 5,
                            clientesActivos: 4,
                            clientesPerdidos: 1,
                            etapas: { prospecto: 4, desembolso: 1 },
                            medioGenerador: { social_manager: 2, referido: 3 },
                            origen: { asesor: 5 }
                        },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { facebook: 1 },
                            origen: { asesor: 0, ia: 1 }
                        },
                        '2025-09-23': { sinDatos: true },
                        '2025-09-24': { sinDatos: true },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                }
            },
            'mazatenango': {
                // Totales de la sede Mazatenango seg√∫n datos Excel
                totalSede: {
                    totalClientes: 23, // 22 + 1 nuevo caso de Marcos
                    clientesActivos: 22, // 21 + 1 nuevo activo de Marcos
                    clientesPerdidos: 1 // Sin cambio
                },
                // Datos individuales de Marcos
                marcos: {
                    nombre: "Marcos",
                    totalClientes: 11, // 10 + 1 nuevo caso
                    clientesActivos: 11, // 10 + 1 nuevo activo
                    clientesPerdidos: 0, // Ninguno perdido
                    etapas: {
                        prospecto: 1, // 18-sep
                        oportunidad: 9, // 8 + 1 nueva
                        negociacion: 0,
                        comite: 0,
                        leads: 1, // 01-sep
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 11, // 10 + 1 nuevo
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0, // Sin referidos seg√∫n Excel
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 11, // 10 + 1 nuevo
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { leads: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-02': { sinDatos: true },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': { sinDatos: true },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': { sinDatos: true },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': {
                            totalClientes: 2,
                            clientesActivos: 2,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 2 },
                            medioGenerador: { social_manager: 2 },
                            origen: { asesor: 2 }
                        },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': { sinDatos: true },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': { sinDatos: true },
                        '2025-09-16': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-17': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-18': {
                            totalClientes: 2,
                            clientesActivos: 2,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1, prospecto: 1 },
                            medioGenerador: { social_manager: 1, referido: 1 },
                            origen: { asesor: 2 }
                        },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-23': { sinDatos: true },
                        '2025-09-24': { sinDatos: true },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                },
                // Datos individuales de Edwin
                edwin: {
                    nombre: "Edwin",
                    totalClientes: 11, // Total casos seg√∫n Excel
                    clientesActivos: 10, // 10 activos
                    clientesPerdidos: 1, // 1 perdido
                    etapas: {
                        prospecto: 1, // 21-sep
                        oportunidad: 9, // Mayor√≠a en oportunidades
                        negociacion: 0,
                        comite: 0,
                        leads: 0,
                        desembolso: 0,
                        desembolsado: 0,
                        reconsideracion: 1 // 01-sep
                    },
                    medioGenerador: {
                        social_manager: 9, // Mayor√≠a por social manager
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 1, // 17-sep
                        visita_oficina: 1 // 13-sep
                    },
                    origen: {
                        asesor: 11, // Todos por asesor seg√∫n Excel
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { reconsideracion: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-02': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': { sinDatos: true },
                        '2025-09-05': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-06': { sinDatos: true },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { visita_oficina: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': {
                            totalClientes: 2,
                            clientesActivos: 2,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 2 },
                            medioGenerador: { social_manager: 2 },
                            origen: { asesor: 2 }
                        },
                        '2025-09-16': { sinDatos: true },
                        '2025-09-17': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { oportunidad: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-18': { sinDatos: true },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': { sinDatos: true },
                        '2025-09-23': { sinDatos: true },
                        '2025-09-24': { sinDatos: true },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                },
                // Datos individuales de Leonel
                leonel: {
                    nombre: "Leonel",
                    totalClientes: 1, // Total casos de Leonel seg√∫n tabla
                    clientesActivos: 1, // Activo
                    clientesPerdidos: 0, // Ninguno perdido
                    etapas: {
                        prospecto: 1, // 08-sep
                        oportunidad: 0,
                        negociacion: 0,
                        comite: 0,
                        leads: 0,
                        desembolso: 0,
                        desembolsado: 0
                    },
                    medioGenerador: {
                        social_manager: 1, // 08-sep es SOCIAL MANAGER
                        whatsapp: 0,
                        facebook: 0,
                        sitio_web: 0,
                        pbx: 0,
                        referido: 0,
                        visita_oficina: 0
                    },
                    origen: {
                        asesor: 1, // Gestionado por asesor
                        ia: 0
                    },
                    porFecha: {
                        '2025-09-01': { sinDatos: true },
                        '2025-09-02': { sinDatos: true },
                        '2025-09-03': { sinDatos: true },
                        '2025-09-04': { sinDatos: true },
                        '2025-09-05': { sinDatos: true },
                        '2025-09-06': { sinDatos: true },
                        '2025-09-07': { sinDatos: true },
                        '2025-09-08': {
                            totalClientes: 1,
                            clientesActivos: 1,
                            clientesPerdidos: 0,
                            etapas: { prospecto: 1 },
                            medioGenerador: { social_manager: 1 },
                            origen: { asesor: 1 }
                        },
                        '2025-09-09': { sinDatos: true },
                        '2025-09-10': { sinDatos: true },
                        '2025-09-11': { sinDatos: true },
                        '2025-09-12': { sinDatos: true },
                        '2025-09-13': { sinDatos: true },
                        '2025-09-14': { sinDatos: true },
                        '2025-09-15': { sinDatos: true },
                        '2025-09-16': { sinDatos: true },
                        '2025-09-17': { sinDatos: true },
                        '2025-09-18': { sinDatos: true },
                        '2025-09-19': { sinDatos: true },
                        '2025-09-20': { sinDatos: true },
                        '2025-09-21': { sinDatos: true },
                        '2025-09-22': { sinDatos: true },
                        '2025-09-23': { sinDatos: true },
                        '2025-09-24': { sinDatos: true },
                        '2025-09-25': { sinDatos: true },
                        '2025-09-26': { sinDatos: true },
                        '2025-09-27': { sinDatos: true },
                        '2025-09-28': { sinDatos: true },
                        '2025-09-29': { sinDatos: true },
                        '2025-09-30': { sinDatos: true }
                    }
                }
            }
        };

        let asesorSeleccionado = null;
        let chartsInstances = {};

        function seleccionarAsesor(asesorId) {
            // Remover clase active de todos los items
            document.querySelectorAll('.asesor-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Agregar clase active al item seleccionado
            event.target.closest('.asesor-item').classList.add('active');
            
            asesorSeleccionado = asesorId;
            const asesorOriginal = asesoresData[asesorId];
            const asesor = obtenerDatosFiltrados(asesorOriginal);
            
            // Actualizar el t√≠tulo del panel
            document.querySelector('.asesores-title').textContent = 'Asesores - Agencia Central';
            
            mostrarDetallesAsesor(asesor);
        }

        function mostrarDetallesAsesor(asesor) {
            const contenido = document.getElementById('contenidoAsesor');
            
            // Determinar el texto de fecha apropiado
            let fechaTexto;
            if (asesor.sinDatos) {
                if (fechaInicio === fechaFin) {
                    const fecha = new Date(fechaInicio + 'T00:00:00');
                    fechaTexto = 'Sin hipotecarios - ' + fecha.toLocaleDateString('es-GT', { day: 'numeric', month: 'long', year: 'numeric' });
                } else {
                    const inicioDate = new Date(fechaInicio + 'T00:00:00');
                    const finDate = new Date(fechaFin + 'T00:00:00');
                    const inicioTexto = inicioDate.toLocaleDateString('es-GT', { day: 'numeric', month: 'long' });
                    const finTexto = finDate.toLocaleDateString('es-GT', { day: 'numeric', month: 'long', year: 'numeric' });
                    fechaTexto = `Sin hipotecarios - ${inicioTexto} al ${finTexto}`;
                }
            } else {
                if (fechaInicio === fechaFin) {
                    const fecha = new Date(fechaInicio + 'T00:00:00');
                    fechaTexto = fecha.toLocaleDateString('es-GT', { day: 'numeric', month: 'long', year: 'numeric' });
                } else if (fechaInicio === '2025-09-01' && fechaFin === '2025-09-30') {
                    fechaTexto = 'Datos de Septiembre 2025';
                } else {
                    const inicioDate = new Date(fechaInicio + 'T00:00:00');
                    const finDate = new Date(fechaFin + 'T00:00:00');
                    const inicioTexto = inicioDate.toLocaleDateString('es-GT', { day: 'numeric', month: 'long' });
                    const finTexto = finDate.toLocaleDateString('es-GT', { day: 'numeric', month: 'long', year: 'numeric' });
                    fechaTexto = `${inicioTexto} al ${finTexto}`;
                }
            }
            
            contenido.innerHTML = `
                <div class="asesor-header">
                    <h2>${asesor.nombre}</h2>
                    <p style="color: ${asesor.sinDatos ? '#999' : '#666'}; font-size: 1rem; margin-top: 5px; font-weight: 500;">${fechaTexto}</p>
                    <div class="asesor-stats">
                        <div class="stat-card">
                            <div class="stat-number">${asesor.totalClientes}</div>
                            <div class="stat-label">Total Casos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${asesor.clientesActivos}</div>
                            <div class="stat-label">Activos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${asesor.clientesPerdidos}</div>
                            <div class="stat-label">Perdidos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">${Math.round(((asesor.etapas.comite || 0) / asesor.totalClientes) * 100)}%</div>
                            <div class="stat-label">En Comit√©</div>
                        </div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <h3 class="chart-title">Distribuci√≥n por Etapas</h3>
                        <canvas id="etapasChart" width="300" height="200"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="chart-title">Medio Generador</h3>
                        <canvas id="mediosChart" width="300" height="200"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3 class="chart-title">Origen de Casos</h3>
                        <canvas id="origenChart" width="300" height="200"></canvas>
                    </div>
                </div>

                <div class="resumen-table">
                    <h3 class="chart-title">Resumen Detallado</h3>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Etapa</th>
                                    <th>Cantidad</th>
                                    <th>Porcentaje</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${asesor.etapas.leads ? `<tr>
                                    <td><span class="status-badge badge-desembolso">Leads</span></td>
                                    <td><strong>${asesor.etapas.leads}</strong></td>
                                    <td>${Math.round((asesor.etapas.leads / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.prospecto ? `<tr>
                                    <td><span class="status-badge badge-prospecto">Prospecto</span></td>
                                    <td><strong>${asesor.etapas.prospecto}</strong></td>
                                    <td>${Math.round((asesor.etapas.prospecto / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.oportunidad ? `<tr>
                                    <td><span class="status-badge badge-oportunidad">Oportunidad</span></td>
                                    <td><strong>${asesor.etapas.oportunidad}</strong></td>
                                    <td>${Math.round((asesor.etapas.oportunidad / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.comite ? `<tr>
                                    <td><span class="status-badge badge-aprobado">Comit√©</span></td>
                                    <td><strong>${asesor.etapas.comite}</strong></td>
                                    <td>${Math.round((asesor.etapas.comite / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.negociacion ? `<tr>
                                    <td><span class="status-badge badge-documentacion">Negociaci√≥n</span></td>
                                    <td><strong>${asesor.etapas.negociacion}</strong></td>
                                    <td>${Math.round((asesor.etapas.negociacion / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.reconsideracion ? `<tr>
                                    <td><span class="status-badge badge-oportunidad">Reconsideraci√≥n</span></td>
                                    <td><strong>${asesor.etapas.reconsideracion}</strong></td>
                                    <td>${Math.round((asesor.etapas.reconsideracion / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.desembolso ? `<tr>
                                    <td><span class="status-badge badge-aprobado">Desembolso</span></td>
                                    <td><strong>${asesor.etapas.desembolso}</strong></td>
                                    <td>${Math.round((asesor.etapas.desembolso / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                                ${asesor.etapas.desembolsado ? `<tr>
                                    <td><span class="status-badge badge-desembolso">Desembolsado</span></td>
                                    <td><strong>${asesor.etapas.desembolsado}</strong></td>
                                    <td>${Math.round((asesor.etapas.desembolsado / asesor.totalClientes) * 100)}%</td>
                                </tr>` : ''}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Esperar un frame para que el DOM se actualice
            setTimeout(() => {
                crearGraficos(asesor);
            }, 10);
        }

        function crearGraficos(asesor) {
            // Destruir gr√°ficos anteriores
            Object.values(chartsInstances).forEach(chart => {
                if (chart) chart.destroy();
            });
            chartsInstances = {};

            const orangeColors = ['#ff7f00', '#ff9500', '#ffb347', '#ffd580', '#ffe0b3'];

            // Gr√°fico de etapas
            const ctxEtapas = document.getElementById('etapasChart');
            if (ctxEtapas) {
                // Establecer tama√±o del canvas
                ctxEtapas.style.height = '300px';
                ctxEtapas.style.width = '100%';
                
                // Definir el orden correcto de etapas
                const etapasOrden = [
                    { key: 'leads', label: 'Leads' },
                    { key: 'prospecto', label: 'Prospecto' },
                    { key: 'oportunidad', label: 'Oportunidad' },
                    { key: 'comite', label: 'Comit√©' },
                    { key: 'negociacion', label: 'Negociaci√≥n' },
                    { key: 'reconsideracion', label: 'Reconsideraci√≥n' },
                    { key: 'desembolso', label: 'Desembolso' },
                    { key: 'desembolsado', label: 'Desembolsado' }
                ];

                // Filtrar solo las etapas que tienen cantidad > 0
                const etapasConDatos = etapasOrden.filter(etapa => (asesor.etapas[etapa.key] || 0) > 0);
                
                const etapasLabels = etapasConDatos.map(etapa => etapa.label);
                const etapasData = etapasConDatos.map(etapa => asesor.etapas[etapa.key] || 0);
                const etapasColors = ['#ff7f00', '#ff9500', '#ffb347', '#ffd580', '#ffe0b3', '#ffcc80', '#ffab40', '#ff8f65'].slice(0, etapasConDatos.length);

                chartsInstances.etapas = new Chart(ctxEtapas, {
                    type: 'doughnut',
                    data: {
                        labels: etapasLabels,
                        datasets: [{
                            data: etapasData,
                            backgroundColor: etapasColors,
                            borderColor: '#fff',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.2,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: { size: 11 }
                                }
                            },
                            datalabels: {
                                display: true,
                                color: 'white',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                },
                                formatter: (value, context) => {
                                    if (value === 0) return '';
                                    return value;
                                }
                            }
                        }
                    }
                });
            }

            // Gr√°fico de medios
            const ctxMedios = document.getElementById('mediosChart');
            if (ctxMedios) {
                // Establecer tama√±o del canvas
                ctxMedios.style.height = '300px';
                ctxMedios.style.width = '100%';
                
                chartsInstances.medios = new Chart(ctxMedios, {
                    type: 'bar',
                    data: {
                        labels: ['Social Manager', 'Sitio Web', 'WhatsApp', 'Referido', 'Visita Oficina', 'PBX'],
                        datasets: [{
                            label: 'Casos',
                            data: [
                                asesor.medioGenerador.social_manager || 0,
                                asesor.medioGenerador.sitio_web || 0,
                                asesor.medioGenerador.whatsapp || 0,
                                asesor.medioGenerador.referido || 0,
                                asesor.medioGenerador.visita_oficina || 0,
                                asesor.medioGenerador.pbx || 0
                            ],
                            backgroundColor: orangeColors,
                            borderColor: '#ff7f00',
                            borderWidth: 2,
                            borderRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.2,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(255, 127, 0, 0.1)' },
                                ticks: {
                                    stepSize: 1
                                }
                            },
                            x: {
                                grid: { display: false }
                            }
                        }
                    }
                });
            }

            // Gr√°fico de origen
            const ctxOrigen = document.getElementById('origenChart');
            if (ctxOrigen) {
                // Establecer tama√±o del canvas
                ctxOrigen.style.height = '300px';
                ctxOrigen.style.width = '100%';
                
                chartsInstances.origen = new Chart(ctxOrigen, {
                    type: 'pie',
                    data: {
                        labels: ['Asesor', 'IA'],
                        datasets: [{
                            data: [
                                asesor.origen.asesor || 0,
                                asesor.origen.ia || 0
                            ],
                            backgroundColor: ['#ff7f00', '#ff9500'],
                            borderColor: '#fff',
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.2,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: { size: 11 }
                                }
                            },
                            datalabels: {
                                display: true,
                                color: 'white',
                                font: {
                                    weight: 'bold',
                                    size: 12
                                },
                                formatter: (value, context) => {
                                    if (value === 0) return '';
                                    return value;
                                }
                            }
                        }
                    }
                });
            }
        }

        function actualizarPanelAsesores(tipo, sedeId = null, sedeNombre = null, asesores = []) {
            const panelAsesores = document.querySelector('.asesores-panel');
            const tituloAsesores = document.querySelector('.asesores-title');
            
            if (tipo === 'agencia-central') {
                tituloAsesores.textContent = 'Asesores - Agencia Central';
                panelAsesores.innerHTML = `
                    <h3 class="asesores-title">Asesores - Agencia Central</h3>
                    ${Object.keys(asesoresData).map(asesorId => {
                        const asesorOriginal = asesoresData[asesorId];
                        const asesor = obtenerDatosFiltrados(asesorOriginal);
                        
                        let estadoTexto;
                        if (fechaInicio === '2025-09-01' && fechaFin === '2025-09-30') {
                            estadoTexto = 'Total';
                        } else if (asesor.sinDatos) {
                            estadoTexto = 'Sin datos';
                        } else if (fechaInicio === fechaFin) {
                            // Un solo d√≠a
                            const fechaObj = new Date(fechaInicio + 'T00:00:00');
                            estadoTexto = fechaObj.toLocaleDateString('es-GT', { day: 'numeric', month: 'short' });
                        } else {
                            // Rango de fechas
                            const inicioObj = new Date(fechaInicio + 'T00:00:00');
                            const finObj = new Date(fechaFin + 'T00:00:00');
                            const inicioTexto = inicioObj.toLocaleDateString('es-GT', { day: 'numeric' });
                            const finTexto = finObj.toLocaleDateString('es-GT', { day: 'numeric', month: 'short' });
                            estadoTexto = `${inicioTexto}-${finTexto}`;
                        }
                        
                        return `
                            <div class="asesor-item" onclick="seleccionarAsesor('${asesorId}')">
                                <div class="asesor-nombre">${asesor.nombre}</div>
                                <div class="asesor-stats">
                                    <span style="color: ${asesor.sinDatos ? '#999' : '#333'}">üìä ${asesor.totalClientes} casos ${estadoTexto !== 'Total' ? '(' + estadoTexto + ')' : ''}</span>
                                    <span style="color: ${asesor.sinDatos ? '#999' : '#333'}">‚úÖ ${asesor.clientesActivos} activos</span>
                                </div>
                            </div>
                        `;
                    }).join('')}
                `;
            } else if (tipo === 'coopexpress') {
                tituloAsesores.textContent = 'Sedes Coopexpress';
                panelAsesores.innerHTML = `
                    <h3 class="asesores-title">Sedes Coopexpress</h3>
                    <div style="padding: 20px; text-align: center; color: #666;">
                        <p>Utiliza el men√∫ de sedes para navegar entre ubicaciones</p>
                    </div>
                `;
            } else if (tipo === 'sede') {
                tituloAsesores.textContent = `Asesores - ${sedeNombre}`;
                panelAsesores.innerHTML = `
                    <h3 class="asesores-title">Asesores - ${sedeNombre}</h3>
                    ${asesores.filter(a => a.toLowerCase() !== 'totalsede').map(asesorNombre => {
                        const asesorKey = asesorNombre.toLowerCase().replace(' ', '');
                        const asesorDataOriginal = coopexpressData[sedeId] && coopexpressData[sedeId][asesorKey];
                        const tieneDatos = asesorDataOriginal && asesorDataOriginal.totalClientes > 0;
                        
                        if (tieneDatos) {
                            const asesorData = obtenerDatosFiltrados(asesorDataOriginal);
                            
                            let estadoTexto;
                            if (fechaInicio === '2025-09-01' && fechaFin === '2025-09-30') {
                                estadoTexto = 'Total';
                            } else if (asesorData.sinDatos) {
                                estadoTexto = 'Sin datos';
                            } else if (fechaInicio === fechaFin) {
                                // Un solo d√≠a
                                const fechaObj = new Date(fechaInicio + 'T00:00:00');
                                estadoTexto = fechaObj.toLocaleDateString('es-GT', { day: 'numeric', month: 'short' });
                            } else {
                                // Rango de fechas
                                const inicioObj = new Date(fechaInicio + 'T00:00:00');
                                const finObj = new Date(fechaFin + 'T00:00:00');
                                const inicioTexto = inicioObj.toLocaleDateString('es-GT', { day: 'numeric' });
                                const finTexto = finObj.toLocaleDateString('es-GT', { day: 'numeric', month: 'short' });
                                estadoTexto = `${inicioTexto}-${finTexto}`;
                            }
                            
                            return `
                                <div class="asesor-item clickeable" onclick="seleccionarAsesorCoopexpress('${sedeId}', '${asesorKey}')">
                                    <div class="asesor-nombre">${asesorNombre}</div>
                                    <div class="asesor-stats">
                                        <span style="color: ${asesorData.sinDatos ? '#999' : '#333'}">üìä ${asesorData.totalClientes} casos ${estadoTexto !== 'Total' ? '(' + estadoTexto + ')' : ''}</span>
                                        <span style="color: ${asesorData.sinDatos ? '#999' : '#333'}">‚úÖ ${asesorData.clientesActivos} activos</span>
                                    </div>
                                </div>
                            `;
                        } else {
                            return `
                                <div class="asesor-item">
                                    <div class="asesor-nombre">${asesorNombre}</div>
                                    <div class="asesor-stats">
                                        <span style="color: #999;">üìã Datos pendientes</span>
                                    </div>
                                </div>
                            `;
                        }
                    }).join('')}
                `;
            }
        }

        // Funciones de navegaci√≥n principal
        // Funci√≥n para mostrar notificaci√≥n visual de filtro
        function mostrarNotificacionFiltro(mensaje) {
            // Crear elemento de notificaci√≥n
            const notificacion = document.createElement('div');
            notificacion.className = 'notificacion-filtro';
            notificacion.innerHTML = `
                <div class="notificacion-content">
                    ${mensaje}
                </div>
            `;
            
            // Agregar al DOM
            document.body.appendChild(notificacion);
            
            // Mostrar con animaci√≥n
            setTimeout(() => {
                notificacion.classList.add('mostrar');
            }, 100);
            
            // Ocultar despu√©s de 3 segundos
            setTimeout(() => {
                notificacion.classList.remove('mostrar');
                setTimeout(() => {
                    if (notificacion.parentNode) {
                        notificacion.parentNode.removeChild(notificacion);
                    }
                }, 300);
            }, 3000);
        }

        // Registrar el plugin de etiquetas de datos
        Chart.register(ChartDataLabels);

        function mostrarAgenciaCentral() {
            // Reiniciar filtro de fechas al rango completo
            fechaInicio = '2025-09-01';
            fechaFin = '2025-09-30';
            document.getElementById('fecha-inicio').value = fechaInicio;
            document.getElementById('fecha-fin').value = fechaFin;
            actualizarInfoRango();
            
            // Mostrar notificaci√≥n de filtro reiniciado
            mostrarNotificacionFiltro('üìÖ Filtro reiniciado - Mostrando datos de todo septiembre');
            
            // Ocultar sedes menu
            document.getElementById('sedes-menu').classList.remove('show');
            
            // Mostrar estad√≠sticas de Agencia Central
            document.getElementById('stats-agencia-central').style.display = 'grid';
            
            // Actualizar estado activo de navegaci√≥n
            document.getElementById('agencia-central-link').classList.add('active');
            document.getElementById('coopexpress-link').classList.remove('active');
            
            // Limpiar selecciones activas de sedes
            document.querySelectorAll('.sede-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Actualizar panel de asesores para Agencia Central
            actualizarPanelAsesores('agencia-central');
            
            // Mostrar vista general de Agencia Central
            mostrarVistaGeneralAgenciaCentral();
        }

        function mostrarCoopexpress() {
            // Reiniciar filtro de fechas al rango completo
            fechaInicio = '2025-09-01';
            fechaFin = '2025-09-30';
            document.getElementById('fecha-inicio').value = fechaInicio;
            document.getElementById('fecha-fin').value = fechaFin;
            actualizarInfoRango();
            
            // Mostrar notificaci√≥n de filtro reiniciado
            mostrarNotificacionFiltro('üìÖ Filtro reiniciado - Mostrando datos de todo septiembre');
            
            // Mostrar sedes menu
            document.getElementById('sedes-menu').classList.add('show');
            
            // Ocultar estad√≠sticas de Agencia Central
            document.getElementById('stats-agencia-central').style.display = 'none';
            
            // Actualizar estado activo de navegaci√≥n
            document.getElementById('coopexpress-link').classList.add('active');
            document.getElementById('agencia-central-link').classList.remove('active');
            
            // Limpiar panel de asesores y mostrar mensaje
            actualizarPanelAsesores('coopexpress');
            
            // Limpiar contenido principal
            const contenido = document.getElementById('contenidoAsesor');
            contenido.innerHTML = `
                <div class="asesor-header">
                    <div style="margin-top: 50px; padding: 30px; text-align: center; color: #999;">
                        <p style="font-size: 1.1rem;">Selecciona una sede para ver los asesores y sus datos de rendimiento</p>
                    </div>
                </div>
            `;
        }

        function mostrarVistaGeneralAgenciaCentral() {
            const contenido = document.getElementById('contenidoAsesor');
            
            // Calcular estad√≠sticas generales
            const totalAsesores = Object.keys(asesoresData).length;
            
            contenido.innerHTML = `
                <div class="asesor-header">
                    <h2>Agencia Central - Vista General</h2>
                    <div style="margin-top: 30px; padding: 25px; background: #fff8f0; border-radius: 15px; border: 1px solid rgba(255, 127, 0, 0.2);">
                        <p style="color: #ff7f00; font-weight: 600; font-size: 1.1rem; margin-bottom: 10px;">üë• Selecciona un asesor</p>
                        <p style="color: #666; margin-top: 5px; line-height: 1.5;">Haz clic en cualquier asesor del panel izquierdo para ver sus datos detallados y gr√°ficos de rendimiento.</p>
                    </div>
                </div>
            `;

            // Actualizar el t√≠tulo del panel
            document.querySelector('.asesores-title').textContent = 'Asesores - Agencia Central';
            
            // Limpiar selecci√≥n activa de asesores
            document.querySelectorAll('.asesor-item').forEach(item => {
                item.classList.remove('active');
            });
        }

        function seleccionarSede(sedeId) {
            // Actualizar estado activo de sedes
            document.querySelectorAll('.sede-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Buscar y activar el elemento de la sede correspondiente
            const sedeElement = document.querySelector(`[onclick="seleccionarSede('${sedeId}')"]`);
            if (sedeElement) {
                sedeElement.classList.add('active');
            }
            
            // Mantener ocultas las estad√≠sticas de Agencia Central
            document.getElementById('stats-agencia-central').style.display = 'none';
            
            // Obtener datos din√°micos filtrados por rango para la sede seleccionada
            const dataSede = coopexpressData[sedeId];
            let totalClientes = 0, clientesActivos = 0, clientesPerdidos = 0;
            let asesores = [];
            if (dataSede) {
                asesores = Object.keys(dataSede);
                asesores.forEach(asesorKey => {
                    const asesor = dataSede[asesorKey];
                    if (asesor && asesor.porFecha) {
                        Object.entries(asesor.porFecha).forEach(([fecha, datos]) => {
                            if (fecha >= fechaInicio && fecha <= fechaFin && !datos.sinDatos) {
                                totalClientes += datos.totalClientes || 0;
                                clientesActivos += datos.clientesActivos || 0;
                                clientesPerdidos += datos.clientesPerdidos || 0;
                            }
                        });
                    }
                });
            }
            // Actualizar panel de asesores para mostrar solo los de esta sede
            actualizarPanelAsesores('sede', sedeId, sedeId.charAt(0).toUpperCase() + sedeId.slice(1), asesores);
            // Mostrar informaci√≥n de la sede en el panel derecho
            const contenido = document.getElementById('contenidoAsesor');
            contenido.innerHTML = `
                <div class="asesor-header">
                    <h2>Sede ${sedeId.charAt(0).toUpperCase() + sedeId.slice(1)}</h2>
                    <div class="estadisticas-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin: 20px 0;">
                        <div class="stat-card" style="background: linear-gradient(135deg, #ff7f00, #ff9500); color: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold;">${totalClientes}</div>
                            <div style="opacity: 0.9; font-size: 0.9rem;">Total Asignados</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold;">${clientesActivos}</div>
                            <div style="opacity: 0.9; font-size: 0.9rem;">Activos</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #dc3545, #fd7e14); color: white; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold;">${clientesPerdidos}</div>
                            <div style="opacity: 0.9; font-size: 0.9rem;">Perdidos</div>
                        </div>
                    </div>
                    <div style="margin-top: 30px; padding: 25px; background: #fff8f0; border-radius: 15px; border: 1px solid rgba(255, 127, 0, 0.2);">
                        <p style="color: #ff7f00; font-weight: 600; font-size: 1.1rem; margin-bottom: 10px;">üë• Selecciona un asesor</p>
                        <p style="color: #666; margin-top: 5px; line-height: 1.5;">Haz clic en cualquier asesor del panel izquierdo para ver sus datos detallados.</p>
                        ${asesores.length > 0 ? `
                            <div style="margin-top: 15px;">
                                <strong style="color: #ff7f00;">Asesores disponibles:</strong>
                                <div style="margin-top: 8px;">
                                    ${asesores.map(asesor => `<span style="background: white; padding: 4px 8px; margin: 2px; border-radius: 4px; border: 1px solid rgba(255,127,0,0.3); display: inline-block; font-size: 0.9rem;">${asesor}</span>`).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function seleccionarAsesorCoopexpress(sedeId, asesorId) {
            const asesorOriginal = coopexpressData[sedeId][asesorId];
            const asesor = obtenerDatosFiltrados(asesorOriginal);
            
            // Limpiar gr√°ficos existentes
            Object.values(chartsInstances).forEach(chart => {
                if (chart) chart.destroy();
            });
            chartsInstances = {};
            
            // Actualizar variable global para compatibilidad
            asesorSeleccionado = asesorId;
            
            // Mostrar detalles usando la misma funci√≥n que Agencia Central
            mostrarDetallesAsesor(asesor);
        }

        function seleccionarSucursal(sucursalId) {
            // Funci√≥n para manejar la selecci√≥n de sucursales de Coopexpress
            const contenido = document.getElementById('contenidoAsesor');
            
            const sucursales = {
                escuintla: { nombre: 'Escuintla', asesores: ['Ana Garc√≠a', 'Pedro Morales'] },
                coban: { nombre: 'Cob√°n', asesores: ['Mar√≠a L√≥pez', 'Juan P√©rez'] },
                '4caminos': { 
                    nombre: '4 Caminos', 
                    asesores: ['Andony'],
                    totales: { totalClientes: 4, clientesActivos: 4, clientesPerdidos: 0 }
                },
                peten: { 
                    nombre: 'Pet√©n', 
                    asesores: ['Elizabeth', 'Oswaldo'],
                    totales: { totalClientes: 9, clientesActivos: 7, clientesPerdidos: 2 }
                },
                mazatenango: { nombre: 'Mazatenango', asesores: ['Andrea Mej√≠a', 'Carlos Hern√°ndez'] }
            };

            const sucursal = sucursales[sucursalId];
            
            contenido.innerHTML = `
                <div class="asesor-header">
                    <h2>Sucursal ${sucursal.nombre}</h2>
                    <p style="color: #666; margin-top: 10px;">Asesores: ${sucursal.asesores.join(', ')}</p>
                    <div style="margin-top: 20px; padding: 20px; background: #fff8f0; border-radius: 10px; border: 1px solid rgba(255, 127, 0, 0.2);">
                        <p style="color: #ff7f00; font-weight: 600;">üìä Dashboard en desarrollo</p>
                        <p style="color: #666; margin-top: 5px;">Los datos de esta sucursal se est√°n configurando y estar√°n disponibles pr√≥ximamente.</p>
                    </div>
                </div>
            `;

            // Actualizar el t√≠tulo del panel
            document.querySelector('.asesores-title').textContent = `Sucursal - ${sucursal.nombre}`;
            
            // Limpiar selecci√≥n activa de asesores
            document.querySelectorAll('.asesor-item').forEach(item => {
                item.classList.remove('active');
            });
        }

        // Inicializaci√≥n al cargar la p√°gina
        window.addEventListener('DOMContentLoaded', function() {
            // Mostrar Agencia Central por defecto
            mostrarAgenciaCentral();
            
            // Configurar estado inicial del filtro
            document.getElementById('agencia-central-link').classList.add('active');
            document.getElementById('coopexpress-link').classList.remove('active');
            
            // Inicializar el filtro de rango de fechas
            actualizarInfoRango();
        });
    </script>
</body>
</html>
